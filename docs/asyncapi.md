# Verona Inferfaces Specification "Editor" 2.0.0 documentation

This is one part of the Verona Online Assessment Standards. All messages are sent via the postMessage function of the html page. The editor takes the page root of its parent as target (parent.window), and the application binds the function call to the iframe element of the editor.
Most important, the message body carries as first parameter the operationId of the message.
## Table of Contents

* [Channels](#channels)

## Channels

### **voeReadyNotification** Channel

#### `subscribe` Operation

*Ready Notification*

The editor announces that it's code is loaded and initialized so the communication can start.

##### Message

###### Payload

| Name | Type | Description | Accepted values |
|-|-|-|-|
| apiVersion **(required)** | string | This lets the application know what verona API version the editor supports. The host will decide whether this declaration matches the requirements of the host or not and which features are not or differently implemented by the editor. | _Any_ |
| notSupportedApiFeatures | string | Space separated list of keys of features not implemented by the player. For details see corresponding player metadata doc! | _Any_ |
| supportedUnitDefinitionTypes | string | Space separated list of keys of unit definition formats supported by the player. After a '@' char, a version might be added (semver-format, caret and tilde might be used). | _Any_ |

> Examples of payload _(generated)_

```json
{
  "apiVersion": "1.1.0",
  "notSupportedApiFeatures": "report-eager",
  "supportedUnitDefinitionTypes": "iqb-scripted@2.4.1"
}
```




### **voeStartCommand** Channel

#### `publish` Operation

*Start Command*

The application sends parameters for editing the unit and commands the start of user interaction.

##### Message

###### Payload

| Name | Type | Description | Accepted values |
|-|-|-|-|
| sessionId **(required)** | string | The session id flags all communication. If a message has no or empty session id, it's not processed. The session id is unique and was generated by the application. Any simple algorithm would work. The session id helps to link the correct unit with the data of the message. Using the id of the editor hosting html element is less reliable, because the element could be reused with another unit. | _Any_ |
| unitDefinition | string | The definition of the unit (if given) to be edited. | _Any_ |
| unitDefinitionType | string | This lets the editor the unit definition format know. This might avoid UI mess after getting old definitions. | _Any_ |
| editorConfig | object | This data supplies some information or instruction about this specific editing of the unit. | _Any_ |
| editorConfig.definitionReportPolicy | string | The host expects the editor to send all changes when happening or only on demand. The latter might lead to better performance. In this case (default), the host triggers report by sending 'voeGetDefinitionRequest'. | eager, on-demand |

> Examples of payload _(generated)_

```json
{
  "sessionId": "idk8ur5jf9ru5jk",
  "unitDefinition": "iqb-scripted::1.4.0 title::Testscript Title2??Hilfetext2 multiple-choice::mc_var1::1::Multiple Choice Feld: ::Choice1##Choice2##Choice3??Hilfetext1 drop-down::dd_var1::1::Dropdown Feld: ::Choice1##Choice2##Choice3??Hilfetext1 checkbox::check_var1::0::Ja klick mal! if-start::dd_var1::1 input-text::jajaj::sap osjxapsoxa if-else input-text::jajaj22::sap osjxapsoxa UUUU text::NOT Choice1 if-end",
  "unitDefinitionType": "iqb-scripted@1.4.0",
  "editorConfig": {
    "definitionReportPolicy": "eager"
  }
}
```




### **voeDefinitionChangedNotification** Channel

#### `subscribe` Operation

*Definition Changed Notification*

The defintion of the unit has changed.

##### Message

###### Payload

| Name | Type | Description | Accepted values |
|-|-|-|-|
| sessionId **(required)** | string | The session id flags all communication. If a message has no or empty session id, it's not processed. The session id is unique and was generated by the application. Any simple algorithm would work. The session id helps to link the correct unit with the data of the message. Using the id of the editor hosting html element is less reliable, because the element could be reused with another unit. | _Any_ |
| timeStamp **(required)** | string | Ensures, that later arriving states are ignored. | _Any_ |
| unitDefinition | string | To be stored. | _Any_ |
| unitDefinitionType | string | In order to understand the defintion outside the editor, the type of the definition should be known. This helps to select a suitable player to run the unit. | _Any_ |

> Examples of payload _(generated)_

```json
{
  "sessionId": "idk8ur5jf9ru5jk",
  "timeStamp": "2019-08-24T14:15:22Z",
  "unitDefinition": "string",
  "unitDefinitionType": "iqb-scripted@1.4.0"
}
```




### **voeGetDefinitionRequest** Channel

#### `publish` Operation

*Get Definition Request*

The application wants the editor to report the last state of the definition. The editor will answer by sending 'voeDefinitionChangedNotification' with full payload.

##### Message

###### Payload

| Name | Type | Description | Accepted values |
|-|-|-|-|
| sessionId **(required)** | string | The session id flags all communication. If a message has no or empty session id, it's not processed. The session id is unique and was generated by the application. Any simple algorithm would work. The session id helps to link the correct unit with the data of the message. Using the id of the editor hosting html element is less reliable, because the element could be reused with another unit. | _Any_ |

> Examples of payload _(generated)_

```json
{
  "sessionId": "idk8ur5jf9ru5jk"
}
```




